<template>
  <div class="status-screen screen">
    <div>
      <h1>Status</h1>
      <p>
        Explorer connected to:
                           <strong v-if="!isLoading">
                             {{ node }}
                           </strong>
                           <FillDummy
                             v-else
                             color="grey"
                           />
      </p>
      <h2>Node and Peers</h2>
      <div class="table-wrapper">
        <table>
          <tr>
            <th>address</th>
            <th>top.height</th>
            <th>top.hash</th>
            <th>top.time</th>
            <th>version.revision</th>
            <th>version.genesis_KeyBlock_hash</th>
          </tr>
          <tr v-if="!isLoading">
            <td><strong>{{ node }}</strong></td>
            <td>{{ nodeStatus.top.keyBlock.height }}</td>
            <td>{{ nodeStatus.top.keyBlock.hash | startAndEnd }}</td>
            <td>{{ nodeStatus.top.keyBlock.time }}</td>
            <td>{{ nodeStatus.version.nodeRevision | startAndEnd }}</td>
            <td>{{ nodeStatus.version.genesisKeyBlockHash | startAndEnd }}</td>
          </tr>
          <tr v-else>
            <td
              v-for="i in 6"
              :key="i"
            >
              <FillDummy color="grey" />
            </td>
          </tr>
        </table>
      </div>
      <h1>Detail</h1>
      <h2 v-if="!isLoading">
        {{ node }}
      </h2>
      <FillDummy
        v-else
        color="grey"
        size="big"
      />
      <h3>version</h3>
      <ObjView
        v-if="!isLoading"
        :obj="nodeStatus.version"
        class="objView"
      />
      <div v-else>
        <div
          v-for="i in 3"
          :key="i"
        >
          <FillDummy color="grey" />
        </div>
      </div>

      <h3>top</h3>
      <ObjView
        v-if="!isLoading"
        :obj="nodeStatus.top"
        class="objView"
      />
      <div v-else>
        <div
          v-for="i in 3"
          :key="i"
        >
          <FillDummy color="grey" />
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import { mapState } from 'vuex'
import pollAction from '../../mixins/pollAction'
import FillDummy from '../../components/fillDummy'
import ObjView from '../../components/objView'

export default {
  components: {
    FillDummy,
    ObjView
  },
  mixins: [pollAction('getNodeStatus')],
  data: function () {
    return {
      newNetworkUrl: '',
      isNetworkChanging: false
    }
  },
  computed: {
    ...mapState({
      nodeStatus: '$nodeStatus',
      node: 'epochUrl'
    }),
    isLoading () {
      return !(this.nodeStatus.top && this.nodeStatus.version)
    }
  }
}
</script>
<style src='./status.scss' lang='scss' />
